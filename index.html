<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Quem matou Odete Roitman?</title>
<style>
:root{
  --bg:#0b1220;--card:#0f172a;--ink:#e5f0ff;--muted:#a8b3c7;--line:#243043;
  --teal:#06b6d4;--blue:#4f46e5;--green:#16a34a;--red:#ef4444;--amber:#f59e0b;
}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui;background:var(--bg);color:var(--ink);font-smooth:always;-webkit-font-smoothing:antialiased}
.wrap{max-width:480px;margin:28px auto;padding:0 16px}
h1{color:var(--amber);text-align:center;margin:0 0 8px;font-size:28px}
.sub{color:var(--muted);text-align:center;margin:0 0 18px}
.card{background:var(--card);border-radius:16px;padding:20px;box-shadow:0 8px 30px rgba(0,0,0,.35)}
.premio{background:#0b1325;border:1px solid #1e293b;border-radius:12px;text-align:center;padding:14px;margin-bottom:18px}
.premio small{color:var(--muted)}
.valor{color:var(--amber);font-size:28px;font-weight:800;margin-top:6px}

/* ====== FOTOS ====== */
.grid{display:flex;gap:10px;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap}
.photo-item{text-align:center;width:calc(25% - 8px)}
.photo{width:72px;height:72px;border-radius:50%;overflow:hidden;border:3px solid transparent;cursor:pointer;transition:.25s;margin:0 auto 6px}
.photo img{width:100%;height:100%;object-fit:cover}
.photo.sel{border-color:var(--amber);transform:scale(1.06)}
.photo-name{font-size:13px;color:var(--muted);text-align:center;word-wrap:break-word}

/* ===== FORM ===== */
label{display:block;color:var(--muted);font-size:13px;margin:10px 0 6px}
input{width:100%;background:#0b1220;color:var(--ink);border:none;border-radius:10px;padding:12px;font-size:15px}
button{width:100%;border:none;border-radius:10px;padding:14px;font-weight:800;font-size:15px;cursor:pointer;transition:.2s}
.btn{background:var(--amber);color:#111;margin-top:14px}
.btn:hover{background:#d97706}
.msg{margin-top:12px;text-align:center;font-size:14px;color:var(--muted)}
.msg.ok{color:var(--green)}
.msg.err{color:var(--red)}
.whats{display:none;background:var(--green);color:#fff;margin-top:10px}
.pix-box{display:none;background:#0b1325;border:1px solid #1e293b;border-radius:10px;padding:10px;margin-top:15px;text-align:center}
.pix-label{color:var(--muted);font-size:14px;margin-bottom:6px}
.pix-key{background:#1e293b;color:var(--ink);padding:8px 10px;border-radius:6px;font-size:14px;word-break:break-all;cursor:pointer;user-select:all}
.copied{color:var(--green);font-size:13px;margin-top:6px}
.total-valor{margin-top:10px;font-size:16px;color:var(--amber);font-weight:700}

/* ===== Overlay ===== */
.overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.85);z-index:9999;justify-content:center;align-items:center;flex-direction:column;color:var(--ink);text-align:center}
.loader{border:4px solid #1e293b;border-top:4px solid var(--amber);border-radius:50%;width:60px;height:60px;animation:spin 1s linear infinite;margin-bottom:16px}
@keyframes spin{100%{transform:rotate(360deg)}}
.overlay p{font-size:1.1em;color:var(--muted)}

/* ===== Popup ===== */
.popup{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.85);z-index:99999;justify-content:center;align-items:center;flex-direction:column}
.popup-content{background:var(--card);padding:20px;border-radius:10px;text-align:center;width:90%;max-width:320px}
.popup-content h3{color:var(--amber);margin:0 0 12px}
.popup-content input{width:100%;padding:10px;border:none;border-radius:8px;background:#0b1220;color:var(--ink);font-size:15px;margin-bottom:12px}
.popup-content button{border:none;padding:10px 14px;border-radius:8px;font-weight:700;cursor:pointer;margin:4px}
.popup-content .ok{background:var(--amber);color:#111}
.popup-content .cancel{background:#1e293b;color:var(--muted)}
</style>
</head>
<body>
<div class="overlay" id="overlay">
  <div class="loader"></div>
  <p>Enviando aposta...</p>
</div>

<!-- Popup para digitar nome -->
<div class="popup" id="popup">
  <div class="popup-content">
    <h3>Digite o nome do suspeito ou sua opini√£o</h3>
    <input id="nomeSuspeito" type="text" placeholder="Ex: Lineu">
    <div>
      <button class="ok" id="confirmSuspeito">Confirmar</button>
      <button class="cancel" id="cancelSuspeito">Cancelar</button>
    </div>
  </div>
</div>

<div class="wrap">
  <h1>Quem matou Odete Roitman?</h1>
  <p class="sub">Participe e concorra ao pr√™mio acumulado, a chave PIX para pagamento ser√° informada ap√≥s enviar a aposta!</p>

  <div class="card">
    <div class="premio">
      <small>Pr√™mio at√© o momento</small>
      <div id="premio" class="valor">R$ 0,00</div>
    </div>

    <div class="grid" id="grid">
      <div class="photo-item" data-nome="Celina">
        <div class="photo"><img src="https://github.com/ClenaStore/barreirense/blob/main/paste/Celine.jpg?raw=true"></div>
        <div class="photo-name">Celina</div>
      </div>
      <div class="photo-item" data-nome="Sezar">
        <div class="photo"><img src="https://github.com/ClenaStore/barreirense/blob/main/paste/Cezar.jpg?raw=true"></div>
        <div class="photo-name">Sezar</div>
      </div>
      <div class="photo-item" data-nome="Heleninha">
        <div class="photo"><img src="https://github.com/ClenaStore/barreirense/blob/main/paste/Heleninha.jpg?raw=true"></div>
        <div class="photo-name">Heleninha</div>
      </div>
      <div class="photo-item" data-nome="Marcos Aur√©lio">
        <div class="photo"><img src="https://github.com/ClenaStore/barreirense/blob/main/paste/Marcus%20Aur%C3%A9lio.jpg?raw=true"></div>
        <div class="photo-name">Marcos Aur√©lio</div>
      </div>
      <div class="photo-item" data-nome="Maria de F√°tima">
        <div class="photo"><img src="https://github.com/ClenaStore/barreirense/blob/main/paste/Maria%20de%20F%C3%A1tima.jpg?raw=true"></div>
        <div class="photo-name">Maria de F√°tima</div>
      </div>
      <div class="photo-item outro" data-nome="">
        <div class="photo"><img src="https://upload.wikimedia.org/wikipedia/commons/8/89/Portrait_Placeholder.png"></div>
        <div class="photo-name">Outro Suspeito ou opini√£o</div>
      </div>
    </div>

    <form id="f">
      <input type="hidden" id="foto">
      <label>Nome completo</label>
      <input id="nome" type="text" required placeholder="Seu nome completo">
      <label>E-mail</label>
      <input id="email" type="email" required placeholder="seu@email.com">
      <label>Telefone / WhatsApp</label>
      <input id="tel" type="tel" required maxlength="16" placeholder="(00) 00000-0000">
      <label>Quantidade de cotas</label>
      <input id="qtd" type="number" min="1" required placeholder="Ex: 3">
      <button id="enviar" class="btn" type="submit">Confirmar Participa√ß√£o</button>
    </form>

    <div id="pixBox" class="pix-box">
      <div class="pix-label">COPIE A CHAVE PARA PAGAMENTO:</div>
      <div id="pixKey" class="pix-key">711e433b-bb4e-477e-adb7-518eacf2f67e</div>
      <div id="totalValor" class="total-valor"></div>
      <div id="copiedMsg" class="copied" style="display:none;">‚úÖ Chave copiada!</div>
    </div>

    <button id="whats" class="whats">üì© Enviar Comprovante pelo WhatsApp</button>
    <div id="msg" class="msg"></div>
  </div>
</div>

<script>
const SCRIPT_URL="https://script.google.com/macros/s/AKfycby99_SCcoL8JSFNRbkidiTRGGcvTLS_Wi4eYw4ZY-MthvV3U8B6HyT2n_4HNL_BxJo-/exec";
const NUMERO_WHATSAPP="5577998253249";
const PIX_KEY="storeclena@gmail.com";
const PRECO=5;

const fotos=document.querySelectorAll(".photo-item");
const fotoH=document.getElementById("foto");
const nome=document.getElementById("nome");
const email=document.getElementById("email");
const tel=document.getElementById("tel");
const qtd=document.getElementById("qtd");
const enviar=document.getElementById("enviar");
const msg=document.getElementById("msg");
const whats=document.getElementById("whats");
const pixBox=document.getElementById("pixBox");
const pixKey=document.getElementById("pixKey");
const copiedMsg=document.getElementById("copiedMsg");
const totalValor=document.getElementById("totalValor");
const overlay=document.getElementById("overlay");
const popup=document.getElementById("popup");
const nomeSuspeito=document.getElementById("nomeSuspeito");
const confirmSuspeito=document.getElementById("confirmSuspeito");
const cancelSuspeito=document.getElementById("cancelSuspeito");

let fotoSelecionada=null;

fotos.forEach(item=>{
  const p=item.querySelector(".photo");
  p.addEventListener("click",()=>{
    fotos.forEach(x=>x.querySelector(".photo").classList.remove("sel"));
    p.classList.add("sel");
    if(item.classList.contains("outro")){
      popup.style.display="flex";
      nomeSuspeito.value="";
      nomeSuspeito.focus();
      fotoSelecionada=item;
    }else{
      fotoH.value=item.dataset.nome;
    }
  });
});

confirmSuspeito.onclick=()=>{
  const nome=nomeSuspeito.value.trim();
  if(nome){
    fotoSelecionada.dataset.nome=nome;
    fotoSelecionada.querySelector(".photo-name").textContent=nome;
    fotoH.value=nome;
    popup.style.display="none";
  }
};
cancelSuspeito.onclick=()=>{popup.style.display="none";};

// m√°scara telefone
tel.addEventListener("input",e=>{
  let v=e.target.value.replace(/\D/g,'').slice(0,11);
  v=v.length>10? v.replace(/^(\d{2})(\d{5})(\d{4}).*/,'($1) $2-$3')
               :v.replace(/^(\d{2})(\d{4})(\d{0,4}).*/,'($1) $2-$3');
  e.target.value=v;
});

// copiar PIX
pixKey.addEventListener("click",async()=>{
  await navigator.clipboard.writeText(PIX_KEY);
  copiedMsg.style.display="block";
  setTimeout(()=>copiedMsg.style.display="none",2000);
});

// atualizar pr√™mio
async function refreshPremio(){
  try{
    const r=await fetch(`${SCRIPT_URL}?action=premio`,{cache:"no-store"});
    const j=await r.json();
    document.getElementById("premio").textContent=j.valor||"R$ 0,00";
  }catch{document.getElementById("premio").textContent="R$ 0,00";}
}
refreshPremio();
setInterval(refreshPremio,6000);

// enviar
document.getElementById("f").addEventListener("submit",async e=>{
  e.preventDefault();
  msg.className="msg";msg.textContent="";
  whats.style.display="none";pixBox.style.display="none";

  if(!fotoH.value){
    msg.textContent="Selecione uma das imagens acima.";
    msg.classList.add("err");
    return;
  }

  enviar.disabled=true;overlay.style.display="flex";

  const payload={action:"registrar",nome:nome.value.trim(),email:email.value.trim(),telefone:tel.value.trim(),qtd:Number(qtd.value),foto:fotoH.value,valor:PRECO,status:"PENDENTE"};

  try{
    const res=await fetch(SCRIPT_URL,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify(payload)});
    const txt=await res.text();
    if(txt.includes("OK")){
      const total=payload.qtd*PRECO;
      msg.textContent="‚úÖ Aposta registrada! Copie a chave PIX e envie o comprovante.";
      msg.classList.add("ok");
      whats.style.display="block";pixBox.style.display="block";
      totalValor.textContent=`Valor a pagar: R$ ${total.toFixed(2).replace('.',',')}`;
      whats.onclick=()=>{
        const m=encodeURIComponent(`Ol√°! Enviando comprovante.\n\nüë§ Nome: ${payload.nome}\nüìû ${payload.telefone}\nüìß ${payload.email}\nüéØ Suspeito: ${payload.foto}\nüí∞ ${payload.qtd} cotas | Total R$ ${total.toFixed(2).replace('.',',')}`);
        window.open(`https://wa.me/${NUMERO_WHATSAPP}?text=${m}`,"_blank");
      };
      qtd.value="";fotoH.value="";fotos.forEach(x=>x.querySelector(".photo").classList.remove("sel"));
      refreshPremio();
    }else if(txt.includes("duplicado")){
      msg.textContent="‚ö†Ô∏è Este telefone j√° possui uma aposta.";msg.classList.add("err");
    }else{
      msg.textContent="‚ùå Erro ao enviar.";msg.classList.add("err");
    }
  }catch{
    msg.textContent="Falha de conex√£o.";msg.classList.add("err");
  }finally{
    overlay.style.display="none";enviar.disabled=false;
  }
});
</script>
</body>
</html>

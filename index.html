<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bol√£o da Sorte üí∞</title>
<style>
:root {
  --bg:#0b1220;
  --card:#141c2f;
  --accent:#f59e0b;
  --accent-hover:#d97706;
  --text:#f8fafc;
  --muted:#9ca3af;
  --green:#22c55e;
  --error:#ef4444;
}
*{box-sizing:border-box;margin:0;padding:0;font-family:Inter,system-ui,Segoe UI;}
body {
  background: var(--bg);
  color: var(--text);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:flex-start;
  min-height:100vh;
}
header {
  text-align:center;
  padding:30px 20px 10px;
}
header h1 {
  color: var(--accent);
  font-size:2rem;
  font-weight:800;
  margin-bottom:8px;
}
header p {
  color: var(--muted);
  font-size:0.95rem;
}
main {
  background: var(--card);
  width:95%;
  max-width:420px;
  padding:24px;
  border-radius:16px;
  box-shadow:0 4px 25px rgba(0,0,0,0.4);
  margin-bottom:30px;
}
#premioCard {
  text-align:center;
  background:#0f172a;
  padding:14px 10px;
  border-radius:10px;
  margin-bottom:22px;
  border:1px solid #1e293b;
}
#premioCard small {
  color: var(--muted);
  font-size:0.85rem;
}
#premioValor {
  font-size:1.8rem;
  font-weight:700;
  color: var(--accent);
  margin:6px 0;
}
.photo-grid {
  display:flex;
  justify-content:space-around;
  flex-wrap:wrap;
  margin-bottom:20px;
}
.photo {
  width:75px;
  height:75px;
  border-radius:50%;
  overflow:hidden;
  cursor:pointer;
  border:3px solid transparent;
  transition:0.3s;
}
.photo img {width:100%;height:100%;object-fit:cover;}
.photo.selected {
  border-color: var(--accent);
  transform:scale(1.08);
}
label {
  display:block;
  color: var(--muted);
  font-size:0.9rem;
  margin-bottom:4px;
  margin-top:10px;
}
input {
  width:100%;
  padding:10px;
  border:none;
  border-radius:8px;
  background:#0f172a;
  color:var(--text);
  font-size:1rem;
}
button {
  width:100%;
  border:none;
  border-radius:8px;
  padding:12px;
  font-weight:700;
  font-size:1rem;
  cursor:pointer;
  transition:0.2s;
}
#btnEnviar {
  background: var(--accent);
  color:#000;
  margin-top:15px;
}
#btnEnviar:hover {background:var(--accent-hover);}
#btnWhatsapp {
  display:none;
  background: var(--green);
  color:#fff;
  margin-top:12px;
}
#btnWhatsapp:hover {opacity:0.9;}
.msg {
  text-align:center;
  font-size:0.9rem;
  margin-top:14px;
  color: var(--muted);
}
.msg.error {color:var(--error);}
.msg.success {color:var(--green);}
footer {
  color:var(--muted);
  font-size:0.8rem;
  margin-bottom:15px;
  text-align:center;
}
</style>
</head>
<body>

<header>
  <h1>Bol√£o da Sorte üéâ</h1>
  <p>Participe e concorra ao pr√™mio acumulado!</p>
</header>

<main>
  <div id="premioCard">
    <div><small>Total do pr√™mio aprovado:</small></div>
    <div id="premioValor">R$ 0,00</div>
  </div>

  <div class="photo-grid">
    <div class="photo"><img src="https://images.unsplash.com/photo-1556740749-887f6717d7e4?w=400" alt="1"></div>
    <div class="photo"><img src="https://images.unsplash.com/photo-1581091215367-59ab6d3213b1?w=400" alt="2"></div>
    <div class="photo"><img src="https://images.unsplash.com/photo-1564869733280-233b6fbc55d0?w=400" alt="3"></div>
    <div class="photo"><img src="https://images.unsplash.com/photo-1550510537-0b38c0d62f5a?w=400" alt="4"></div>
  </div>

  <form id="formBolao">
    <label>Nome completo</label>
    <input type="text" id="nome" required placeholder="Seu nome completo">

    <label>E-mail</label>
    <input type="email" id="email" required placeholder="seu@email.com">

    <label>Telefone / WhatsApp</label>
    <input type="tel" id="telefone" required placeholder="(00) 00000-0000" maxlength="16">

    <label>Quantidade de cotas</label>
    <input type="number" id="qtd" min="1" required placeholder="Ex: 3">

    <input type="hidden" id="fotoSelecionada" value="">
    <button id="btnEnviar" type="submit">Confirmar Participa√ß√£o</button>
  </form>

  <button id="btnWhatsapp">üì© Enviar Comprovante pelo WhatsApp</button>

  <div id="msg" class="msg"></div>
</main>

<footer>¬© 2025 ‚Ä¢ Bol√£o da Sorte ‚Ä¢ Boa sorte a todos! üçÄ</footer>

<script>
/* ======== CONFIG ======== */
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxDEvsHO-Y2QB6KaNfgK-yjHfJMRUOtjunQGK7Aswj4grwYUcAic9SG_awC2nHru0hB/exec";
const NUMERO_WHATSAPP = "5577998253249";
const valorCota = 5;

/* ======== ELEMENTOS ======== */
const msg = document.getElementById('msg');
const premioValor = document.getElementById('premioValor');
const btnEnviar = document.getElementById('btnEnviar');
const btnWhatsapp = document.getElementById('btnWhatsapp');

/* ======== M√ÅSCARA TELEFONE ======== */
document.getElementById('telefone').addEventListener('input', e=>{
  let v=e.target.value.replace(/\D/g,'').slice(0,11);
  if(v.length>10) v=v.replace(/^(\d{2})(\d{5})(\d{4}).*/,'($1) $2-$3');
  else v=v.replace(/^(\d{2})(\d{4})(\d{0,4}).*/,'($1) $2-$3');
  e.target.value=v;
});

/* ======== FOTO ======== */
document.querySelectorAll('.photo').forEach(f=>{
  f.addEventListener('click',()=>{
    document.querySelectorAll('.photo').forEach(x=>x.classList.remove('selected'));
    f.classList.add('selected');
    document.getElementById('fotoSelecionada').value=f.querySelector('img').src;
  });
});

/* ======== ATUALIZA PREMIO ======== */
async function atualizarPremio(){
  try{
    const r=await fetch(SCRIPT_URL+"?action=premio",{cache:'no-store'});
    const j=await r.json();
    premioValor.textContent=j.valor||"R$ 0,00";
  }catch{
    premioValor.textContent="R$ 0,00";
  }
}
setInterval(atualizarPremio,5000);
atualizarPremio();

/* ======== FORM ======== */
document.getElementById('formBolao').addEventListener('submit', async e=>{
  e.preventDefault();
  msg.textContent="";
  msg.className="msg";
  btnEnviar.disabled=true;

  const nome=document.getElementById('nome').value.trim();
  const email=document.getElementById('email').value.trim();
  const telefone=document.getElementById('telefone').value.trim();
  const qtd=document.getElementById('qtd').value;
  const foto=document.getElementById('fotoSelecionada').value;

  if(!foto){
    msg.textContent="Selecione uma das op√ß√µes acima.";
    msg.classList.add('error');
    btnEnviar.disabled=false;
    return;
  }

  const data={action:"registrar",nome,email,telefone,qtd,foto,valor:valorCota,status:"PENDENTE"};

  try{
    const res=await fetch(SCRIPT_URL,{
      method:"POST",
      headers:{"Content-Type":"text/plain;charset=utf-8"},
      body:JSON.stringify(data)
    });
    const txt=await res.text();

    if(txt.includes("OK")){
      const total=Number(qtd)*valorCota;
      msg.textContent="‚úÖ Aposta registrada! Agora envie seu comprovante pelo WhatsApp.";
      msg.classList.add('success');
      btnWhatsapp.style.display='block';

      btnWhatsapp.onclick=()=>{
        const mensagem=encodeURIComponent(
          `Ol√°! Enviando meu comprovante do Bol√£o da Sorte.\n\nüë§ Nome: ${nome}\nüìû Telefone: ${telefone}\nüìß E-mail: ${email}\nüí∞ ${qtd} cotas | Total: R$ ${(total).toFixed(2).replace('.',',')}`
        );
        window.open(`https://wa.me/${NUMERO_WHATSAPP}?text=${mensagem}`,'_blank');
        msg.textContent="‚úÖ Comprovante enviado. Boa sorte!";
      };
    }else if(txt.includes("duplicado")){
      msg.textContent="‚ö†Ô∏è Este telefone j√° possui aposta registrada.";
      msg.classList.add('error');
    }else{
      msg.textContent="‚ùå Erro ao enviar. Tente novamente.";
      msg.classList.add('error');
    }
  }catch{
    msg.textContent="Erro de conex√£o com o servidor.";
    msg.classList.add('error');
  }finally{
    btnEnviar.disabled=false;
  }
});
</script>

</body>
</html>
